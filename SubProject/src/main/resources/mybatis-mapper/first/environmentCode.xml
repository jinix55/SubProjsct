<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.portal.adm.environmentCode.mapper.EnvironmentCodeMapper">

	<sql id="paging">
		LIMIT #{offSet}, #{pageSize}
	</sql>
	
	
	<select id="selectGroupIdList" resultType="com.portal.adm.environmentCode.model.EnvironmentCodeModel" parameterType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		SELECT
			ROW_NUMBER() OVER (ORDER BY ORD_SEQ ASC) AS ROWNUM,
			GROUP_ID,
			CODE_ID,
			CODE_KEY,
			CODE_NM,
			CODE_DSC,
			ORD_SEQ,
			RPT_MAT_STRUCT,
			RPT_DEV_ANAL,
			RPT_VISUAL_JUDG,
			RPT_TEST,
			RPT_PERMISSION,
			RPT_ETC,
			USE_YN,
			RGST_ID,
			RGST_DT,
			MODI_ID,
			MODI_DT
		FROM T_ENVIRONMENT_CODE
		where GROUP_ID = #{groupId} 
		ORDER BY ROWNUM ASC
		<include refid="paging"></include>
	</select>

	<select id="selectGroupIdListCount" resultType="int" parameterType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		SELECT
			COUNT(*)
		FROM
			T_ENVIRONMENT_CODE
		WHERE
			GROUP_ID = #{groupId}
	</select>

	<select id="selectGroupIdAllList" resultType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		SELECT
			ROW_NUMBER() OVER (ORDER BY ORD_SEQ ASC) AS ROWNUM,
			GROUP_ID,
			CODE_ID,
			CODE_KEY,
			CODE_NM,
			CODE_DSC,
			USE_YN,
			RGST_ID,
			RGST_DT,
			MODI_ID,
			MODI_DT,
			ORD_SEQ
		FROM
			T_ENVIRONMENT_CODE
		WHERE
			GROUP_ID = #{groupId}
		ORDER BY ROWNUM
	</select>
	
	
	<select id="selectList" resultType="com.portal.adm.environmentCode.model.EnvironmentCodeModel" parameterType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		SELECT
			GROUP_ID,
			CODE_ID,
			CODE_KEY,
			CODE_NM,
			CODE_DSC,
			USE_YN,
			RGST_ID,
			RGST_DT,
			MODI_ID,
			MODI_DT
		FROM
			T_ENVIRONMENT_CODE
		WHERE
			GROUP_ID = #{groupId}
	</select>

	<select id="select" resultType="com.portal.adm.environmentCode.model.EnvironmentCodeModel" parameterType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		SELECT
			GROUP_ID,
			CODE_ID,
			CODE_KEY,
			ORD_SEQ,
			CODE_NM,
			CODE_DSC,
			RPT_MAT_STRUCT,
			RPT_DEV_ANAL,
			RPT_VISUAL_JUDG,
			RPT_TEST,
			RPT_PERMISSION,
			RPT_ETC,
			USE_YN,
			RGST_ID,
			RGST_DT,
			MODI_ID,
			MODI_DT
		FROM
			T_ENVIRONMENT_CODE
		WHERE
			CODE_ID = #{codeId} AND GROUP_ID = #{groupId}
	</select>

	<insert id="insert" parameterType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		INSERT INTO T_ENVIRONMENT_CODE (
			GROUP_ID
			, CODE_ID
			, CODE_KEY
			, CODE_NM
			, CODE_DSC
			, RPT_MAT_STRUCT
			, RPT_DEV_ANAL
			, RPT_VISUAL_JUDG
			, RPT_TEST
			, RPT_PERMISSION
			, RPT_ETC
			, USE_YN
			, RGST_ID
			, RGST_DT
			, MODI_ID
			, MODI_DT
			, ORD_SEQ
		) VALUES (
			#{groupId}
			, #{codeId}
			, #{codeKey}
			, #{codeNm}
			, #{codeDsc}
			, #{rptMatStruct}
			, #{rptDevAnal}
			, #{rptVisualJudg}
			, #{rptTest}
			, #{rptPermission}
			, #{rptEtc}
			, #{useYn}
			, #{rgstId}
			, now()
			, #{modiId}
			, now()
			, #{ordSeq}
		)
	</insert>

	<update id="update" parameterType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		UPDATE T_ENVIRONMENT_CODE
		SET
			CODE_NM = #{codeNm}
			, CODE_KEY = #{codeKey}
			, CODE_DSC = #{codeDsc}
			, MODI_DT = now()
			, MODI_ID = #{modiId}
			, USE_YN = #{useYn}
			, ORD_SEQ = #{ordSeq}
			, RPT_MAT_STRUCT = #{rptMatStruct}
			, RPT_DEV_ANAL = #{rptDevAnal}
			, RPT_VISUAL_JUDG = #{rptVisualJudg}
			, RPT_TEST = #{rptTest}
			, RPT_PERMISSION = #{rptPermission}
			, RPT_ETC = #{rptEtc}
		WHERE
			GROUP_ID = #{groupId}
		AND
			CODE_ID = #{codeId}
	</update>

	<delete id="delete" parameterType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		DELETE FROM T_ENVIRONMENT_CODE
		WHERE GROUP_ID = #{groupId} AND CODE_ID = #{codeId}
	</delete>
	
	<delete id="deleteDownCode" parameterType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		DELETE FROM T_ENVIRONMENT_CODE
		WHERE GROUP_ID = #{codeId} 
	</delete>

	<select id="selectCodeCountForGroupId" resultType="int" parameterType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		SELECT COUNT(*)
		FROM T_ENVIRONMENT_CODE
		WHERE GROUP_ID = #{codeId}
		AND USE_YN = 'Y'
	</select>
	
	
	<select id="selectMatTypeList" resultType="com.portal.adm.environmentCode.model.EnvironmentCodeModel">
		select  
			  b.group_id
			, b.code_id
			, a.code_nm
			, b.code_nm code_nm2
		from    
			  T_ENVIRON_PRICE a
			, T_ENVIRON_PRICE b
		where   1 = 1
		  and   a.use_yn = 'Y'
	   	  and   b.use_yn = 'Y'
		  and   a.group_id = 'group_id'
  	  	  and   a.code_id = b.group_id
        order by 
        		a.ord_seq , b.ord_seq
	</select>	
	
	<select id="getPartList" resultType="com.portal.adm.environmentCode.model.EnvironmentCodeModel"  parameterType="String">
		select 
			  a.code_id
		    , a.code_nm
		from 
			  t_environment_code a
		where 1 = 1
		and   a.USE_YN = 'Y'
		and   a.GROUP_ID = #{groupId}
		ORDER BY a.ORD_SEQ
		 
		

	</select>		
</mapper>